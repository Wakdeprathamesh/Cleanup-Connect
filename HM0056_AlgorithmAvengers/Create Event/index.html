<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Create Event</title>
  <!-- Include Bootstrap CSS (or any other styling framework) -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <!-- Link to Custom CSS -->
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="container mt-5">
    <h2>Create Event</h2>
    <!-- Error Messages Display -->
    <div id="errorMessages"></div>
    
    <form id="createForm">
      <!-- Event Title -->
      <div class="form-group">
        <label for="eventTitle">Event Title:</label>
        <input type="text" class="form-control" id="eventTitle" name="eventTitle" placeholder="Enter Event Title" required>
      </div>

      <!-- Event Description -->
      <div class="form-group">
        <label for="eventDescription">Event Description:</label>
        <textarea class="form-control" id="eventDescription" name="eventDescription" rows="5" placeholder="Enter Event Description" required></textarea>
      </div>

      <!-- Date and Time -->
      <div class="form-row">
        <div class="form-group col-md-6">
          <label for="eventDate">Event Date:</label>
          <input type="date" class="form-control" id="eventDate" name="eventDate" required>
        </div>
        <div class="form-group col-md-6">
          <label for="eventTime">Event Time:</label>
          <input type="time" class="form-control" id="eventTime" name="eventTime" required>
        </div>
      </div>

      <!-- Location -->
      <div class="form-group">
        <label for="eventLocation">Event Location:</label>
        <input type="text" class="form-control" id="eventLocation" name="eventLocation" placeholder="Enter Event Location" required>
      </div>

      <!-- Goals and Objectives -->
      <div class="form-group">
        <label for="eventGoals">Goals and Objectives:</label>
        <textarea class="form-control" id="eventGoals" name="eventGoals" rows="3" placeholder="Enter Goals and Objectives"></textarea>
      </div>

      <!-- Equipment Needed -->
      <div class="form-group">
        <label>Equipment Needed:</label>
        <div class="form-check">
          <input class="form-check-input" type="checkbox" id="trashBags" name="equipment" value="Trash Bags">
          <label class="form-check-label" for="trashBags">Trash Bags</label>
        </div>
        <div class="form-check">
          <input class="form-check-input" type="checkbox" id="gloves" name="equipment" value="Gloves">
          <label class="form-check-label" for="gloves">Gloves</label>
        </div>
        <!-- Add more equipment checkboxes as needed -->
      </div>

      <!-- Special Instructions for Volunteers -->
      <div class="form-group">
        <label for="specialInstructions">Special Instructions for Volunteers:</label>
        <textarea class="form-control" id="specialInstructions" name="specialInstructions" rows="3" placeholder="Enter Special Instructions"></textarea>
      </div>

      <!-- Collaboration Opportunities -->
      <div class="form-group form-check">
        <input type="checkbox" class="form-check-input" id="collaboration" name="collaboration">
        <label class="form-check-label" for="collaboration">Open for Collaboration with Businesses</label>
      </div>

      <!-- Organizer's Gmail/Email -->
      <div class="form-group">
        <label for="organizerEmail">Organizer's Gmail/Email:</label>
        <input type="email" class="form-control" id="organizerEmail" name="organizerEmail" placeholder="Enter Organizer's Gmail/Email" required>
        <div class="invalid-feedback">Please enter a valid email address</div>
      </div>

      <!-- Submit Button -->
      <button type="submit" class="btn btn-primary">Create Event</button>
    </form>
  </div>

  <!-- Include Bootstrap JS (if needed) -->
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/js/bootstrap.min.js"></script>

 


  <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-auth-compat.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.js"></script>

  <script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
  import { getFirestore, collection, getDocs, query, where } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";
  import { doc, getDoc , addDoc  } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";


  
  
    // Initialize Firebase
    const firebaseConfig = {
      apiKey: "AIzaSyA1NgEx9i0gCwGvA97ouWZWQBkwuiAsrm0",
    authDomain: "cleanup-connect-ebaae.firebaseapp.com",
    databaseURL: "https://cleanup-connect-ebaae-default-rtdb.asia-southeast1.firebasedatabase.app",
    projectId: "cleanup-connect-ebaae",
    storageBucket: "cleanup-connect-ebaae.appspot.com",
    messagingSenderId: "206124027034",
    appId: "1:206124027034:web:423e5574fce9877e562323"
      };
    
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
 
    const form = document.getElementById("createForm");
    const errorMessages = document.getElementById("errorMessages");
    
    form.addEventListener("submit", async (e)=> {
      e.preventDefault();
      // Reset error messages
      console.log(1212);
      errorMessages.innerHTML = "";
      
      let errors = [];
    
      // Validate Event Title
      const eventTitle = form.elements["eventTitle"].value;
      if (!eventTitle.trim()) {
        errors.push("Please enter an Event Title");
      }
    
      // Validate Organizer's Gmail/Email
      const organizerEmail = form.elements["organizerEmail"].value;
      if (!isValidEmail(organizerEmail)) {
        errors.push("Please enter a valid Organizer's Gmail/Email");
      }
    
      // Validate Event Date
      const eventDate = form.elements["eventDate"].value;
      if (!isValidDate(eventDate)) {
        errors.push("Please enter a valid Event Date");
      }
    
      // Validate Event Time
      const eventTime = form.elements["eventTime"].value;
      if (!isValidTime(eventTime)) {
        errors.push("Please enter a valid Event Time");
      }
    
      // Display Error Messages
      if (errors.length > 0) {
        event.preventDefault();
        errors.forEach(function(error) {
          const errorElement = document.createElement("div");
          errorElement.classList.add("alert", "alert-danger");
          errorElement.textContent = error;
          errorMessages.appendChild(errorElement);
        });
      }

      let eventLocation = document.getElementById("eventLocation").value;

      let eventDescription = document.getElementById("eventDescription").value;

      try{

        // Assume `db` is a reference to your Firestore database
const eventsRef = db.collection("Events");

// Use `doc()` without any arguments to generate a new unique document ID
const newEventDocRef = eventsRef.doc();

// Get the new document ID generated by Firestore
const newEventId = newEventDocRef.id;

// Set the data for the new event
newEventDocRef.set({
          eventTitle : eventTitle,
          organizerEmail : organizerEmail,
          eventDate : eventDate,
          eventTime : eventTime,
          eventLocation : eventLocation,
          eventDescription : eventDescription
        })
      } catch (e) {
        console.error("Error adding document: ", e);
      }  
    });
    
    // Custom Email Validation Function
    function isValidEmail(email) {
      const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      return emailRegex.test(email);
    }
    
    // Custom Date Validation Function
    function isValidDate(date) {
      const today = new Date().toISOString().split("T")[0];
      return date >= today;
    }
    
    // Custom Time Validation Function
    function isValidTime(time) {
      // Add your custom time validation logic here
      return true;
    }
  
  // Redirect to login page if user is not signed in
  // if (!user) {
  //   console.log('User is not signed in');
  //   window.location.href = 'login.html'; // Redirect to the login page
  // }</script>
</body>
</html>
